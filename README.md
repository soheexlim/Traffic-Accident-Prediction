# Final Project: Predicting Traffic Accidents Based on Weather and Time Data in Greater Boston Area

## 1. Project Overview
This project aims to predict the likelihood of traffic accidents in the Greater Boston Metropolitan Area by leveraging historical crash data enriched with weather and time-related features. Using machine learning models, the goal is to estimate the probability of accidents under various conditions, such as rain, nighttime, or rush hour. 

The insights generated from this project can be used by transportation agencies, city planners, and navigation services to provide actionable recommendations or warnings for accident-prone areas and times. By identifying key factors influencing accident risks, this project seeks to contribute to safer road systems and more informed decision-making.

---

## 2. Goals and Objectives

Traffic accidents are influenced by a range of environmental and temporal factors, making predictive modeling a valuable tool for proactive safety measures. The **primary goal** of this project is to develop a machine learning model capable of predicting the likelihood of accidents based on key features such as weather, time of day, road conditions, and rush hour status. For example, the model might estimate that there is a 70% chance of an accident at a specific location on a rainy weekday during rush hour.

In addition to prediction, the project aims to identify the most significant factors influencing accidents. The **secondary goal** involves analyzing the impact of variables like rain combined with nighttime driving or rush hour to understand how these combinations elevate risks. These insights will be critical for designing effective interventions.

---

## 3. Data Sources and Features

### Data Sources
The dataset merges crash records from 2022 and 2023, sourced from [Massachusetts Crash Portal](https://massdot-impact-crashes-vhb.opendata.arcgis.com/). Each crash record includes details such as location, date, time, weather conditions, and road surface conditions. Temporal features like holidays and rush hour indicators were added using external libraries and engineering techniques. Weather data was simplified into categories (e.g., rain, clear, snow) to enhance interpretability.

### Key Features
The dataset includes the following critical features:
- **Crash Timing**: Date, time, and derived indicators like day of the week, nighttime, and rush hour.
- **Weather Conditions**: Simplified categories such as clear, rain, snow, and fog.
- **Road Conditions**: Surface conditions, junction types, and ambient lighting.
- **Interaction Terms**: Combined features like weather during rush hour or weather at night.

By combining these features, the dataset provides a comprehensive foundation for analyzing accident risks under various conditions.

---

## 4. Data Processing and Feature Engineering

### Initial Data Cleaning
The raw dataset originally contained over 120 columns, many of which were irrelevant or incomplete. Columns with over 50% missing values, redundant identifiers, or excessive granularity (e.g., street names) were removed, leaving a streamlined set of 16 key variables. Additionally, the dataset was filtered to include only crashes within the Greater Boston Metropolitan Area, using a predefined list of cities and towns.

### Feature Engineering
To enhance the predictive power of the dataset, several new features were engineered:
- **Datetime Features**: 
  - `CRASH_DATETIME` was created by combining date and time fields. From this, additional features such as `DAY_OF_WEEK`, `IS_NIGHT`, `IS_RUSH_HOUR`, and `IS_HOLIDAY` were derived.
- **Weather Simplification**:
  - Weather descriptions were grouped into broader categories like "Rain," "Clear," and "Snow," and encoded numerically.
- **Speed Limit Ranges**:
  - Speed limits were categorized into `<30 mph`, `30–50 mph`, and `>50 mph` ranges to simplify analysis.
- **Interaction Terms**:
  - Features like `WEATHER_RUSH_HOUR` and `WEATHER_NIGHT` were created to capture the combined effects of weather and temporal conditions.

### Synthetic Data Generation
Since the dataset primarily consisted of crash records, it was imbalanced. To address this, synthetic non-accident data was generated by simulating realistic conditions where crashes were less likely. Weighted probabilities were assigned to features like weather, time of day, and road surface conditions, ensuring the synthetic data reflected real-world distributions.

---

## 5. Data Modeling

### Approach to Modeling
The dataset was merged, shuffled, and split into training (80%) and testing (20%) subsets. Multiple machine learning models were employed to predict the likelihood of accidents, with a focus on optimizing accuracy and reliability.

### Models Used
1. **Logistic Regression**:
   - A simple baseline model for binary classification.
2. **Random Forest**:
   - Optimized using Bayesian hyperparameter tuning to enhance accuracy and reduce overfitting.
3. **Gradient Boosting (XGBoost)**:
   - Captures non-linear relationships between features and the target variable.
4. **Neural Network**:
   - A deep learning model with two hidden layers and dropout regularization to prevent overfitting.
5. **Stacking Classifier**:
   - Combines predictions from Random Forest, XGBoost, and Gradient Boosting using Logistic Regression as a meta-classifier.

### Calibration and Evaluation
To improve the reliability of probability predictions, isotonic and sigmoid calibrations were applied to the models. Evaluation metrics included accuracy, F1 score, and confusion matrices to assess both precision and recall. 

---

## 6. Preliminary Visualizations and Insights

### Key Insights
- **Accidents During Rush Hour**:
  - Rush hour significantly increases the likelihood of accidents, especially during adverse weather conditions.
- **Nighttime Accidents**:
  - Though less frequent, nighttime accidents tend to be more severe, possibly due to reduced visibility and driver fatigue.
- **Weather Conditions**:
  - Rain and snow were found to increase accident risks compared to clear weather.

### Sample Visualizations
#### Bar Chart: Accidents by Rush Hour
![Accidents by Rush Hour](https://github.com/user-attachments/assets/70507ae4-2b5e-4b24-b651-a55ce0dddab1)

#### Correlation Heatmap
![Correlation Heatmap](https://github.com/user-attachments/assets/6b148ea5-7b51-4089-b353-76524613e535)

#### Interaction Term: Weather and Rush Hour
![Weather and Rush Hour](https://github.com/user-attachments/assets/3f98db15-184b-4fb2-99ae-9e24d2397093)

---

## 7. Evaluation Metrics and Results

### Metrics Used
1. **Accuracy**: Proportion of correct predictions.
2. **F1 Score**: Harmonic mean of precision and recall, particularly valuable for imbalanced datasets.
3. **Confusion Matrix**: Breakdown of true/false positives and negatives.

### Baseline Accuracy
A naïve model predicting the majority class (no accidents) achieved a baseline accuracy of approximately 70%. Models significantly outperformed this baseline.

---

## 8. Future Work and Applications

### Next Steps
1. **Feature Expansion**:
   - Incorporate additional variables such as traffic volume, road type, or seasonal trends.
2. **Deployment**:
   - Build an interactive dashboard for real-time accident prediction and visualization.
3. **Deeper Analysis**:
   - Investigate feature importance to identify the most critical predictors of accidents.

### Practical Applications
This model can be used by transportation agencies for proactive interventions, such as dynamic speed limits or targeted public safety campaigns. Navigation services could integrate the predictions to alert drivers about high-risk areas or times.

---

## Midterm Report and Presentation
- **YouTube Link**: [https://youtu.be/xDtrSEpDA7s](https://youtu.be/xDtrSEpDA7s)

---

